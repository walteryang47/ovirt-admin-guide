# 虚拟机关联（Virtual Machine Affinity）介绍

虚拟机关联允许用户定义一组规则来指定是否一组特定的虚拟机需要在同一个主机上运行，或需要在不同的主机上运行。这个功能可以被用来处理复杂的运行负载需求，例如软件许可证的要求，高可用性对负载的要求。

虚拟机关联通过把虚拟机加入到一个或多个关联组（affinity group）来实现。一个关联组包括两个或两个以上的虚拟机，它们有相同的参数和运行条件。这些参数包括 positive 关联（在这个关联组的虚拟机需要在同一个主机上运行）和 negative 关联（在这个关联组中的虚拟机需要在不同的主机上运行）。

另外，其它一组条件会被用来和这些参数一起使用。例如，您可以设置硬实施（hard enforcement），它将强制执行您所设置的参数，而不会考虑外部环境；您也可以设置软实施（soft enforcement），它将在外部条件允许的前提下尽量执行您所设置的参数。

关联组、它的参数和条件并称为关联协议（affinity policy）。


> **注意**
>
> 关联组在集群的范围内应用于虚拟机。如果一个虚拟机被从一个集群移到另一个集群，这个虚拟机也会从它原来所在集群的关联组中被删除。



> **重要**
>
> 关联组只有在关联组的集群的集群策略的 **VmAffinityGroups** 过滤器模块或者权重模块启用时才能生效。**VmAffinityGroups** 过滤器模块用来实现硬性过滤条件，**VmAffinityGroups** 权重模块用来实现软性过滤条件。
